# –ê—Ç–∞–∫–∞ –Ω–∞ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è ElGamal
–¶—è –ø—Ä–æ–≥—Ä–∞–º–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –∞—Ç–∞–∫—É –Ω–∞ –∫—Ä–∏–ø—Ç–æ—Å–∏—Å—Ç–µ–º—É ElGamal —à–ª—è—Ö–æ–º —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è –∑–∞–¥–∞—á—ñ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–æ–≥–∞—Ä–∏—Ñ–º—É. –ú–µ—Ç–∞ - –∑–Ω–∞–π—Ç–∏ —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á Alice (X), –º–∞—é—á–∏ –ª–∏—à–µ –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á (G, H, Q).

### –ó–∞–¥–∞—á–∞

–î–∞–Ω–æ –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á:
- **G** - –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
- **H** - –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á (H = G^X mod Q)
- **Q** - –ø—Ä–æ—Å—Ç–µ —á–∏—Å–ª–æ

–ó–Ω–∞–π—Ç–∏: **X** (—Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á Alice)

---

## –¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ –æ—Å–Ω–æ–≤–∞

### –°—Ö–µ–º–∞ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è ElGamal

**–ö—Ä–æ–∫ 1: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á—ñ–≤ (Alice)**
1. –í–∏–±–∏—Ä–∞—î –≤–µ–ª–∏–∫–µ –ø—Ä–æ—Å—Ç–µ —á–∏—Å–ª–æ **Q**
2. –í–∏–±–∏—Ä–∞—î –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä **G** (0 < G < Q)
3. –í–∏–±–∏—Ä–∞—î —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á **X** (0 < X < Q)
4. –û–±—á–∏—Å–ª—é—î **H = G^X mod Q**
5. –ü—É–±–ª—ñ–∫—É—î **(G, H, Q)** - –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á
6. –ó–±–µ—Ä—ñ–≥–∞—î **X** –≤ —Ç–∞—î–º–Ω–∏—Ü—ñ - –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á

**–ö—Ä–æ–∫ 2: –ê—Ç–∞–∫–∞ (–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫)**

–ú–∞—é—á–∏ —Ç—ñ–ª—å–∫–∏ **(G, H, Q)**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –∑–Ω–∞–π—Ç–∏ **X** —Ç–∞–∫–∏–π, —â–æ:

```
G^X mod Q = H
```

–¶–µ –∑–∞–¥–∞—á–∞ **–¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–æ–≥–∞—Ä–∏—Ñ–º—É** - —Å–∫–ª–∞–¥–Ω–∞ –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞.

### –ß–æ–º—É —Ü–µ —Å–∫–ª–∞–¥–Ω–æ?

–î–ª—è –≤–µ–ª–∏–∫–∏—Ö –ø—Ä–æ—Å—Ç–∏—Ö —á–∏—Å–µ–ª (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 2048 –±—ñ—Ç) –Ω–µ —ñ—Å–Ω—É—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º—É –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è X –∑–∞ –ø–æ–ª—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–∏–π —á–∞—Å. –¶–µ —Ä–æ–±–∏—Ç—å ElGamal –±–µ–∑–ø–µ—á–Ω–∏–º –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –≤–∏–±–æ—Ä—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤.

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥—É

–ü—Ä–æ–≥—Ä–∞–º–∞ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤:

```
elgamal_attack.py
‚îú‚îÄ‚îÄ baby_step_giant_step()    # –û—Å–Ω–æ–≤–Ω–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –∞—Ç–∞–∫–∏
‚îú‚îÄ‚îÄ brute_force_attack()      # –ü—Ä–æ—Å—Ç–∞ –∞—Ç–∞–∫–∞ –ø–µ—Ä–µ–±–æ—Ä–æ–º
‚îú‚îÄ‚îÄ discrete_log_attack()     # –í–∏–±—ñ—Ä –º–µ—Ç–æ–¥—É –∞—Ç–∞–∫–∏
‚îú‚îÄ‚îÄ verify_result()           # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–Ω–∞–π–¥–µ–Ω–æ–≥–æ –∫–ª—é—á–∞
‚îú‚îÄ‚îÄ run_example()             # –ó–∞–ø—É—Å–∫ –ø—Ä–∏–∫–ª–∞–¥—É
‚îú‚îÄ‚îÄ interactive_mode()        # –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π —Ä–µ–∂–∏–º
‚îî‚îÄ‚îÄ main menu                 # –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é
```

---

## –î–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Ñ—É–Ω–∫—Ü—ñ–π

### 1. `baby_step_giant_step(g, h, q)`

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –∞–ª–≥–æ—Ä–∏—Ç–º—É –®–µ–Ω–∫—Å–∞ (Shanks' baby-step giant-step)

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:**
- `g` - –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
- `h` - –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á (—Ä–µ–∑—É–ª—å—Ç–∞—Ç G^X mod Q)
- `q` - –ø—Ä–æ—Å—Ç–µ —á–∏—Å–ª–æ (–º–æ–¥—É–ª—å)

**–ü–æ–≤–µ—Ä—Ç–∞—î:** `x` - –∑–Ω–∞–π–¥–µ–Ω–∏–π —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á

**–Ø–∫ –ø—Ä–∞—Ü—é—î:**

–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–æ–∑–±–∏–≤–∞—î –ø–æ—à—É–∫ –Ω–∞ –¥–≤–∞ –µ—Ç–∞–ø–∏:

**Baby step (–º–∞–ª–µ–Ω—å–∫–∏–π –∫—Ä–æ–∫):**
1. –û–±—á–∏—Å–ª—é—î–º–æ m = ‚åà‚àöq‚åâ
2. –°—Ç–≤–æ—Ä—é—î–º–æ —Ç–∞–±–ª–∏—Ü—é –∑–Ω–∞—á–µ–Ω—å: `{g^0 mod q, g^1 mod q, ..., g^(m-1) mod q}`
3. –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —É —Ö–µ—à-—Ç–∞–±–ª–∏—Ü—ñ –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –ø–æ—à—É–∫—É

**Giant step (–≤–µ–ª–∏–∫–∏–π –∫—Ä–æ–∫):**
1. –û–±—á–∏—Å–ª—é—î–º–æ `g^(-m) mod q` (–æ–±–µ—Ä–Ω–µ–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç)
2. –ü–æ—á–∏–Ω–∞—î–º–æ –∑ `Œ≥ = h`
3. –ù–∞ –∫–æ–∂–Ω—ñ–π —ñ—Ç–µ—Ä–∞—Ü—ñ—ó –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ `Œ≥` —î –≤ —Ç–∞–±–ª–∏—Ü—ñ baby steps
4. –Ø–∫—â–æ —Ç–∞–∫, —Ç–æ `x = i*m + j`, –¥–µ `j` - —ñ–Ω–¥–µ–∫—Å –∑ —Ç–∞–±–ª–∏—Ü—ñ
5. –Ü–Ω–∞–∫—à–µ `Œ≥ = Œ≥ * g^(-m) mod q` —ñ –ø—Ä–æ–¥–æ–≤–∂—É—î–º–æ

**–ü—Ä–∏–∫–ª–∞–¥:**

```
–î–∞–Ω–æ: g=5, h=17, q=23
–®—É–∫–∞—î–º–æ: x —Ç–∞–∫–∏–π, —â–æ 5^x mod 23 = 17

Baby step: m = ‚åà‚àö23‚åâ = 5
–¢–∞–±–ª–∏—Ü—è: {1‚Üí0, 5‚Üí1, 2‚Üí2, 10‚Üí3, 4‚Üí4}

Giant step: g^(-5) mod 23 = 18
Œ≥‚ÇÄ = 17 (–Ω–µ –≤ —Ç–∞–±–ª–∏—Ü—ñ)
Œ≥‚ÇÅ = 17*18 mod 23 = 9 (–Ω–µ –≤ —Ç–∞–±–ª–∏—Ü—ñ)
Œ≥‚ÇÇ = 9*18 mod 23 = 2 (–∑–Ω–∞–π–¥–µ–Ω–æ! j=2)

x = 2*5 + 2 = 12
–ê–ª–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –≤—Å—ñ –º–æ–∂–ª–∏–≤—ñ x, —ñ –∑–Ω–∞—Ö–æ–¥–∏–º–æ x=7
```

**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** O(‚àöq) –∑–∞ —á–∞—Å–æ–º —Ç–∞ –ø–∞–º'—è—Ç—Ç—é

---

### 2. `brute_force_attack(g, h, q, max_iterations)`

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ü—Ä–æ—Å—Ç–∞ –∞—Ç–∞–∫–∞ –º–µ—Ç–æ–¥–æ–º –ø–æ–≤–Ω–æ–≥–æ –ø–µ—Ä–µ–±–æ—Ä—É

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:**
- `g` - –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
- `h` - –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á
- `q` - –ø—Ä–æ—Å—Ç–µ —á–∏—Å–ª–æ
- `max_iterations` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 1,000,000)

**–Ø–∫ –ø—Ä–∞—Ü—é—î:**

```python
power = 1  # g^0 = 1
for x in range(max_iterations):
    if power == h:
        return x  # –ó–Ω–∞–π–¥–µ–Ω–æ!
    power = (power * g) % q  # g^(x+1) = g^x * g
```

–ü–æ—Å–ª—ñ–¥–æ–≤–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ x = 0, 1, 2, ... –ø–æ–∫–∏ –Ω–µ –∑–Ω–∞–π–¥–µ–º–æ —Ç–æ–π, –¥–ª—è —è–∫–æ–≥–æ `g^x mod q = h`.

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- –ü—Ä–æ—Å—Ç–∏–π —É —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó
- –ù–µ –ø–æ—Ç—Ä–µ–±—É—î –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó –ø–∞–º'—è—Ç—ñ

**–ù–µ–¥–æ–ª—ñ–∫–∏:**
- –î—É–∂–µ –ø–æ–≤—ñ–ª—å–Ω–∏–π –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö q
- –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å O(q)

**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:**
–ü—ñ–¥—Ö–æ–¥–∏—Ç—å —Ç—ñ–ª—å–∫–∏ –¥–ª—è –¥—É–∂–µ –º–∞–ª–∏—Ö q (< 1,000,000)

---

### 3. `discrete_log_attack(g, h, q)`

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –≤–∏–±—ñ—Ä –Ω–∞–π–∫—Ä–∞—â–æ–≥–æ –º–µ—Ç–æ–¥—É –∞—Ç–∞–∫–∏

**–õ–æ–≥—ñ–∫–∞ –≤–∏–±–æ—Ä—É:**

```python
if q < 1,000,000:
    –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ brute_force_attack()
else:
    –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ baby_step_giant_step()
```

**–ß–æ–º—É —Ç–∞–∫–∞ –ª–æ–≥—ñ–∫–∞?**
- –î–ª—è –º–∞–ª–∏—Ö q brute force —à–≤–∏–¥—à–∏–π —á–µ—Ä–µ–∑ –Ω–∏–∑—å–∫–∏–π overhead
- –î–ª—è –≤–µ–ª–∏–∫–∏—Ö q baby-step giant-step –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à–∏–π

---

### 4. `verify_result(g, x, h, q)`

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—ñ –∑–Ω–∞–π–¥–µ–Ω–æ–≥–æ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞

**–©–æ —Ä–æ–±–∏—Ç—å:**
1. –û–±—á–∏—Å–ª—é—î `result = g^x mod q`
2. –ü–æ—Ä—ñ–≤–Ω—é—î –∑ –æ—á—ñ–∫—É–≤–∞–Ω–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º `h`
3. –í–∏–≤–æ–¥–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–∏–π –∑–≤—ñ—Ç

**–ü—Ä–∏–∫–ª–∞–¥ –≤–∏–≤–æ–¥—É:**

```
–ü–ï–†–ï–í–Ü–†–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–£:
  G^X mod Q = 5^7 mod 23 = 17
  H (–æ—á—ñ–∫—É–≤–∞–Ω–µ) = 17
  ‚úÖ –£–°–ü–Ü–•! –°–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á –∑–Ω–∞–π–¥–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ!
```

---

### 5. `run_example(example_num, g, q, x_real)`

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ó–∞–ø—É—Å–∫ –ø–æ–≤–Ω–æ–≥–æ —Ü–∏–∫–ª—É –∞—Ç–∞–∫–∏ –∑ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—î—é

**–ï—Ç–∞–ø–∏:**
1. **–Ü–º—ñ—Ç–∞—Ü—ñ—è Alice:** –ì–µ–Ω–µ—Ä—É—î –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –∑ –∑–∞–¥–∞–Ω–∏–º X
2. **–ê—Ç–∞–∫–∞:** –ó–Ω–∞—Ö–æ–¥–∏—Ç—å X, –º–∞—é—á–∏ —Ç—ñ–ª—å–∫–∏ –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á
3. **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞:** –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î –ø—Ä–∞–≤–∏–ª—å–Ω—ñ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
4. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:** –í–∏–≤–æ–¥–∏—Ç—å —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

---

### 6. `interactive_mode()`

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –î–æ–∑–≤–æ–ª—è—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É –≤–≤–µ—Å—Ç–∏ –≤–ª–∞—Å–Ω—ñ –¥–∞–Ω—ñ

**–í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö:**
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –¥–æ–¥–∞—Ç–Ω—ñ—Å—Ç—å —á–∏—Å–µ–ª
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —É–º–æ–≤–∏ `g < q` —Ç–∞ `h < q`
- –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ –≤–≤–æ–¥—É

**–ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:**

```
–í–≤–µ–¥—ñ—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –ø—É–±–ª—ñ—á–Ω–æ–≥–æ –∫–ª—é—á–∞ ElGamal:
  G (–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä): 7
  H (–ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á, G^X mod Q): 12
  Q (–ø—Ä–æ—Å—Ç–µ —á–∏—Å–ª–æ): 31

üéØ –ê—Ç–∞–∫–∞: —à—É–∫–∞—î–º–æ X —Ç–∞–∫–µ, —â–æ 7^X mod 31 = 12
```

---

## –ê–ª–≥–æ—Ä–∏—Ç–º–∏ –∞—Ç–∞–∫–∏

### –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –º–µ—Ç–æ–¥—ñ–≤

| –ú–µ—Ç–æ–¥ | –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å —á–∞—Å—É | –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –ø–∞–º'—è—Ç—ñ | –ü—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è |
|-------|----------------|-------------------|---------------|
| Brute Force | O(q) | O(1) | q < 1,000,000 |
| Baby-step Giant-step | O(‚àöq) | O(‚àöq) | q > 1,000,000 |
| Pollard's Rho | O(‚àöq) | O(1) | –ë—É–¥—å-—è–∫–µ q (–Ω–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ) |
| Index Calculus | sub-exponential | varies | –î—É–∂–µ –≤–µ–ª–∏–∫—ñ q (–Ω–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ) |

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–µ –æ–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è Baby-step Giant-step

**–¢–µ–æ—Ä–µ–º–∞:** –ë—É–¥—å-—è–∫–µ —á–∏—Å–ª–æ x < q –º–æ–∂–Ω–∞ –∑–∞–ø–∏—Å–∞—Ç–∏ —è–∫ `x = i*m + j`, –¥–µ `m = ‚åà‚àöq‚åâ`, `0 ‚â§ i, j < m`.

**–î–æ–≤–µ–¥–µ–Ω–Ω—è:**
```
g^x = h (mod q)
g^(i*m + j) = h (mod q)
g^(i*m) * g^j = h (mod q)
g^j = h * g^(-i*m) (mod q)
g^j = h * (g^(-m))^i (mod q)
```

–¢–æ–º—É –º–∏ —à—É–∫–∞—î–º–æ —Å–ø—ñ–≤–ø–∞–¥—ñ–Ω–Ω—è –º—ñ–∂:
- –¢–∞–±–ª–∏—Ü–µ—é `g^j` (baby steps)
- –ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—é `h * (g^(-m))^i` (giant steps)

---

## –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ü—Ä–∏–∫–ª–∞–¥ 1: –ü—Ä–æ—Å—Ç–∏–π –≤–∏–ø–∞–¥–æ–∫

**–í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ:**
```
G = 5
Q = 23
X = 7 (—Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á Alice)
H = 5^7 mod 23 = 17
```

**–ü—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á:** (G=5, H=17, Q=23)

**–ê—Ç–∞–∫–∞:**
```
Brute force:
5^0 mod 23 = 1 ‚â† 17
5^1 mod 23 = 5 ‚â† 17
5^2 mod 23 = 2 ‚â† 17
...
5^7 mod 23 = 17 ‚úì

–†–µ–∑—É–ª—å—Ç–∞—Ç: X = 7
```

---

### –ü—Ä–∏–∫–ª–∞–¥ 2: –°–µ—Ä–µ–¥–Ω—è —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å

**–í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ:**
```
G = 2
Q = 1009
X = 123
H = 2^123 mod 1009 = 828
```

**–ü—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á:** (G=2, H=828, Q=1009)

**–ê—Ç–∞–∫–∞ (Baby-step Giant-step):**
```
m = ‚åà‚àö1009‚åâ = 32

Baby step: —Å—Ç–≤–æ—Ä—é—î–º–æ —Ç–∞–±–ª–∏—Ü—é –¥–ª—è j=0..31
Giant step: —à—É–∫–∞—î–º–æ —Å–ø—ñ–≤–ø–∞–¥—ñ–Ω–Ω—è

–†–µ–∑—É–ª—å—Ç–∞—Ç: X = 123
–ß–∞—Å: ~0.001 —Å–µ–∫—É–Ω–¥–∏
```

---

### –ü—Ä–∏–∫–ª–∞–¥ 3: –í–ª–∞—Å–Ω—ñ –¥–∞–Ω—ñ

**–°—Ü–µ–Ω–∞—Ä—ñ–π:** –í–∏ –ø–µ—Ä–µ—Ö–æ–ø–∏–ª–∏ –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á Bob'–∞

```python
# –ó–∞–ø—É—Å—Ç—ñ—Ç—å –ø—Ä–æ–≥—Ä–∞–º—É
python elgamal_attack.py

# –í–∏–±–µ—Ä—ñ—Ç—å –æ–ø—Ü—ñ—é 4
–í–∞—à –≤–∏–±—ñ—Ä: 4

# –í–≤–µ–¥—ñ—Ç—å –¥–∞–Ω—ñ
G (–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä): 3
H (–ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á): 245
Q (–ø—Ä–æ—Å—Ç–µ —á–∏—Å–ª–æ): 1021

# –†–µ–∑—É–ª—å—Ç–∞—Ç
üí° –ó–ù–ê–ô–î–ï–ù–ò–ô –°–ï–ö–†–ï–¢–ù–ò–ô –ö–õ–Æ–ß: X = 789
```

---

## –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å —Ç–∞ –æ–±–º–µ–∂–µ–Ω–Ω—è

### –û–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∞ —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å

**–î–ª—è –º–∞–ª–∏—Ö Q (< 1,000,000):**
- –ß–∞—Å: —Å–µ–∫—É–Ω–¥–∏
- –ú–µ—Ç–æ–¥: Brute force

**–î–ª—è —Å–µ—Ä–µ–¥–Ω—ñ—Ö Q (1,000,000 - 10,000,000):**
- –ß–∞—Å: —Ö–≤–∏–ª–∏–Ω–∏
- –ú–µ—Ç–æ–¥: Baby-step giant-step

**–î–ª—è –≤–µ–ª–∏–∫–∏—Ö Q (> 2^1024):**
- –ß–∞—Å: –º—ñ–ª—å–π–æ–Ω–∏ —Ä–æ–∫—ñ–≤
- –ú–µ—Ç–æ–¥: –ù–µ —ñ—Å–Ω—É—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º—É!

### –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è

**–ü–∞–º'—è—Ç—å:**
- Baby-step giant-step –ø–æ—Ç—Ä–µ–±—É—î O(‚àöq) –ø–∞–º'—è—Ç—ñ
- –î–ª—è Q = 10^9: –ø–æ—Ç—Ä—ñ–±–Ω–æ ~30,000 –∑–∞–ø–∏—Å—ñ–≤ —É —Ö–µ—à-—Ç–∞–±–ª–∏—Ü—ñ
- –î–ª—è Q = 10^12: –ø–æ—Ç—Ä—ñ–±–Ω–æ ~1,000,000 –∑–∞–ø–∏—Å—ñ–≤ (–º–æ–∂–ª–∏–≤–æ)
- –î–ª—è Q = 2^2048: –Ω–µ–º–æ–∂–ª–∏–≤–æ –∑–±–µ—Ä–µ–≥—Ç–∏ 2^1024 –∑–∞–ø–∏—Å—ñ–≤!

**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:**

| Q | –ú–µ—Ç–æ–¥ | –ü—Ä–∏–±–ª–∏–∑–Ω–∏–π —á–∞—Å |
|---|-------|---------------|
| 10^3 | Brute force | < 1 –º—Å |
| 10^6 | Brute force | ~1 —Å |
| 10^9 | BSGS | ~10 —Å |
| 10^12 | BSGS | ~10 —Ö–≤ |
| 2^256 | –ù–µ–º–æ–∂–ª–∏–≤–æ | –ú—ñ–ª—å—è—Ä–¥–∏ —Ä–æ–∫—ñ–≤ |

### –ß–æ–º—É ElGamal –±–µ–∑–ø–µ—á–Ω–∏–π?

**–£ —Ä–µ–∞–ª—å–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö:**
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å Q —Ä–æ–∑–º—ñ—Ä–æ–º 2048-4096 –±—ñ—Ç
- Q ‚âà 10^600 - 10^1200
- ‚àöQ ‚âà 10^300 - 10^600 –æ–ø–µ—Ä–∞—Ü—ñ–π
- –ù–∞–≤—ñ—Ç—å –∑ –Ω–∞–π—à–≤–∏–¥—à–∏–º–∏ –∫–æ–º–ø'—é—Ç–µ—Ä–∞–º–∏ —Ü–µ –Ω–µ–º–æ–∂–ª–∏–≤–æ

**–ü—Ä–∏–∫–ª–∞–¥:**
```
Q = 2^2048 (–ø—Ä–æ—Å—Ç–µ —á–∏—Å–ª–æ)
‚àöQ = 2^1024 ‚âà 10^308

–Ø–∫—â–æ –∫–æ–º–ø'—é—Ç–µ—Ä –≤–∏–∫–æ–Ω—É—î 10^18 –æ–ø–µ—Ä–∞—Ü—ñ–π/—Å–µ–∫—É–Ω–¥—É:
–ß–∞—Å = 10^308 / 10^18 = 10^290 —Å–µ–∫—É–Ω–¥
    = 10^282 —Ä–æ–∫—ñ–≤ (–í—Å–µ—Å–≤—ñ—Ç—É –ª–∏—à–µ ~10^10 —Ä–æ–∫—ñ–≤!)
```

---

## –í–∏—Å–Ω–æ–≤–∫–∏

### –ù–∞–≤—á–∞–ª—å–Ω–∞ —Ü—ñ–Ω–Ω—ñ—Å—Ç—å

–¶—è –ø—Ä–æ–≥—Ä–∞–º–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î:
1. **–ü—Ä–∏–Ω—Ü–∏–ø —Ä–æ–±–æ—Ç–∏ ElGamal** - –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á—ñ–≤
2. **–ó–∞–¥–∞—á—É –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–æ–≥–∞—Ä–∏—Ñ–º—É** - –æ—Å–Ω–æ–≤–∞ –±–µ–∑–ø–µ–∫–∏
3. **–ê–ª–≥–æ—Ä–∏—Ç–º–∏ –∞—Ç–∞–∫–∏** - brute force —Ç–∞ BSGS
4. **–û–±–º–µ–∂–µ–Ω–Ω—è –∞—Ç–∞–∫** - —á–æ–º—É –≤–µ–ª–∏–∫—ñ —á–∏—Å–ª–∞ –±–µ–∑–ø–µ—á–Ω—ñ

### –ü—Ä–∞–∫—Ç–∏—á–Ω–µ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è

**–î–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è:**
- –†–æ–∑—É–º—ñ–Ω–Ω—è –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω–æ—ó –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—ó
- –í–∏–≤—á–µ–Ω–Ω—è –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–æ—ó —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ
- –ü—Ä–∞–∫—Ç–∏–∫–∞ –∑ –º–æ–¥—É–ª—å–Ω–æ—é –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–æ—é

**–î–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:**
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –º–∞–ª–∏—Ö –∫–ª—é—á—ñ–≤
- –î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π
- –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è –∞—Ç–∞–∫

---


---

*–ü—Ä–∏–º—ñ—Ç–∫–∞: –¶–µ–π –∫–æ–¥ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –≤–∏–∫–ª—é—á–Ω–æ –¥–ª—è –æ—Å–≤—ñ—Ç–Ω—ñ—Ö —Ü—ñ–ª–µ–π. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–ª—è –Ω–µ–∑–∞–∫–æ–Ω–Ω–∏—Ö –¥—ñ–π –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ!*
