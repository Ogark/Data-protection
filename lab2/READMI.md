# Caesar Cipher Decoder with Frequency Analysis

### Принцип роботи шифрування

Шифр Цезаря працює шляхом **зсуву кожної літери** в повідомленні на фіксовану кількість позицій в алфавіті.

#### Приклад шифрування (зсув = 3):

```
Відкритий текст:  A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
                  ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓
Зашифрований:     D E F G H I J K L M N O P Q R S T U V W X Y Z A B C
```

**Приклад:**
- **Вхідний текст:** `HELLO WORLD`
- **Зсув:** 3
- **Зашифрований текст:** `KHOOR ZRUOG`

**Пояснення:**
- H → K (H + 3)
- E → H (E + 3)
- L → O (L + 3)
- L → O (L + 3)
- O → R (O + 3)

### Циклічність алфавіту

Якщо літера при зсуві виходить за межі алфавіту, вона "обертається" на початок:

```
X + 3 = A (X → Y → Z → A)
Y + 3 = B (Y → Z → A → B)
Z + 3 = C (Z → A → B → C)
```

## Математична формула

Для шифрування літери використовується формула:

```
E(x) = (x + k) mod 26
```

Для розшифрування:

```
D(x) = (x - k) mod 26
```

Де:
- `x` — позиція літери в алфавіті (A=0, B=1, ..., Z=25)
- `k` — ключ зсуву (0-25)
- `mod 26` — операція остачі від ділення на 26 (для циклічності)

## Частотний аналіз

### Що це таке?

**Частотний аналіз** — це метод криптоаналізу, який базується на тому, що в будь-якій мові різні літери зустрічаються з різною частотою.

### Частоти літер в англійській мові

| Літера | Частота | Літера | Частота |
|--------|---------|--------|---------|
| E | 12.56% | T | 9.15% |
| A | 8.08% | O | 7.47% |
| N | 7.38% | I | 7.24% |
| R | 6.42% | S | 6.59% |
| H | 5.27% | L | 4.04% |
| D | 3.99% | C | 3.18% |

**Найчастіша літера в англійській:** **E** (12.56%)  
**Найрідкісніші літери:** **Q** (0.09%), **Z** (0.07%)

### Як це допомагає розшифрувати?

1. Якщо текст зашифрований зсувом 3, то літера **E** стане **H**
2. Отже, в зашифрованому тексті літера **H** буде найчастішою
3. Програма пробує всі 26 можливих зсувів
4. Для кожного зсуву перевіряє, чи схожі частоти на англійські
5. Вибирає зсув з найкращою відповідністю

## Тест хі-квадрат (Chi-Squared Test)

Для вимірювання "схожості" розшифрованого тексту з англійською мовою використовується **статистичний тест хі-квадрат**.

### Формула

```
χ² = Σ [(Oᵢ - Eᵢ)² / Eᵢ]
```

Де:
- `Oᵢ` (Observed) — спостережена кількість літери `i` в тексті
- `Eᵢ` (Expected) — очікувана кількість літери `i` в англійському тексті
- `χ²` — показник невідповідності (менше = краще)

### Приклад розрахунку

Припустимо, у тексті 100 літер:

**Літера E:**
- Очікується: 12.56% від 100 = **12.56 літер**
- Спостерігається: **15 літер**
- Вклад у χ²: `(15 - 12.56)² / 12.56 = 0.47`

**Літера Q:**
- Очікується: 0.09% від 100 = **0.09 літер**
- Спостерігається: **5 літер**
- Вклад у χ²: `(5 - 0.09)² / 0.09 = 268.01` (ВЕЛИКА невідповідність!)

**Висновок:** якщо χ² великий — текст НЕ схожий на англійську. Якщо малий — схожий!

## Як працює програма

### Алгоритм покроково

```
1. Прочитати зашифроване повідомлення
2. Для кожного можливого зсуву (0-25):
   a. Розшифрувати текст з цим зсувом
   b. Підрахувати частоти літер
   c. Обчислити χ² (порівняння з англійською)
   d. Зберегти результат
3. Вибрати зсув з найменшим χ²
4. Вивести розшифроване повідомлення
```

## Структура коду

### 1. Функція `shift_text(text, shift)`

**Призначення:** Зсуває літери в тексті на задану кількість позицій.

**Особливості:**
- Обробляє тільки літери (A-Z, a-z)
- Зберігає регістр (велика/мала літера)
- Не змінює цифри, пробіли, розділові знаки

**Приклад:**
```python
shift_text("Hello, World!", 3)
# Результат: "Khoor, Zruog!"
```

### 2. Функція `calculate_chi_squared(text)`

**Призначення:** Обчислює статистичну міру схожості тексту з англійською мовою.

**Кроки:**
1. Підрахувати кількість кожної літери в тексті
2. Обчислити очікувану кількість за частотами англійської
3. Порівняти спостережене з очікуваним (формула χ²)
4. Повернути результат (менше = краще)

### 3. Функція `decode_caesar_cipher(encoded_message)`

**Призначення:** Головна функція декодування.

**Алгоритм:**
1. Перебрати всі 26 можливих зсувів
2. Для кожного зсуву:
   - Розшифрувати текст
   - Оцінити якість розшифрування (χ²)
3. Вибрати зсув з найкращою оцінкою
4. Повернути остаточно розшифрований текст

## Приклади використання

### Приклад 1: Базове використання

**Вхід:**
```
Khoor Zruog !
```

**Вихід:**
```
Hello World !
```

**Виявлений зсув:** 3

---

### Приклад 2: Цитата Шекспіра

**Вхід:**
```
Gb or, be abg gb or: gung vf gur dhrfgvba.
```

**Вихід:**
```
To be, or not to be: that is the question.
```

**Виявлений зсув:** 13 (ROT13)

---

## Встановлення та запуск

### Запуск програми

#### Варіант 1: Інтерактивний режим

```bash
python caesar_decoder.py
```

Потім введіть зашифроване повідомлення та натисніть Enter.

#### Варіант 2: Через pipe

```bash
echo "Khoor Zruog !" | python caesar_decoder.py
```

#### Варіант 3: З файлу

```bash
python caesar_decoder.py < input.txt
```

або

```bash
python caesar_decoder.py < input.txt > output.txt
```


## Тестування

### Тестові випадки

| # | Зашифрований текст | Зсув | Очікуваний результат |
|---|-------------------|------|---------------------|
| 1 | `Khoor Zruog!` | 3 | `Hello World!` |
| 2 | `Rovvy, Gybvn!` | 10 | `Hello, World!` |
| 3 | `Wkh txlfn eurzq ira` | 23 | `The quick brown fox` |

